<div class="title text-[32px] font-semibold">
  <h1>Inbox</h1>
</div>

<div class="inbox-content">
  <!-- Left Sidebar -->
  <div class="inbox-navigation xl:shadow-none" [class.shadow-xl]="isNavShow()">
    <!-- Compose Button -->
   
    <div class="flex justify-center xl:justify-between items-center mb-6 gap-2">
      @if(isNavShow()) {
        <button
          class="w-full bg-[#4880FF] bg-opacity-90 text-[14px] text-white font-bold py-3 px-4 rounded-lg hover:bg-opacity-100 transition-all"
          (click)="onCompose()">
          + Compose
        </button>
      }
      
      <button class="xl:hidden" (click)="toggleShow()">
        <img src="/assets/sidebar-icons/settings.svg" alt="menu" class="size-[24px]">
      </button>
    </div>

    <!-- My Email Section -->
    <div class="mb-6">
       @if(isNavShow()) {
        <h3 class="font-bold text-[16px] text-gray-800 mb-4">My Email</h3>
       }

      <!-- Email Folders -->
      <div class="space-y-1">
        @for (folder of folders; track folder) {
          <div
            class="flex items-center justify-between py-2 px-3 rounded-lg cursor-pointer transition-all duration-200 min-h-[36px]"
            [ngClass]="folder.isActive ? 'bg-[#487fff21]' : 'hover:bg-gray-50'"
            (click)="selectFolder(folder)">
            <div class="flex items-center gap-3">
              <img src="{{folder.icon}}" alt="{{ folder.name }}" [class.active]="folder.isActive">
              <span class="font-semibold text-sm"
              [ngClass]="folder.isActive ? 'text-[#4880FF] font-bold' : 'text-gray-800'"
              [class.hidden]="!isNavShow()">{{ folder.name }}</span>
            </div>
            <span class="font-semibold text-sm"
            [ngClass]="folder.isActive ? 'text-[#4880FF]' : 'text-gray-800 opacity-60'"
            [class.hidden]="!isNavShow()">{{ folder.count | number }}</span>
          </div>
        }
      </div>
    </div>

    <!-- Labels Section -->
    <div class="mb-6">
       @if(isNavShow()) {
        <h3 class="font-bold text-base text-gray-800 mb-4">Label</h3>
       }
      
      <div class="space-y-1">
        @for (label of labels; track label) {
          <div
            class="flex items-center gap-3 py-2 px-3 hover:bg-gray-50 rounded-lg cursor-pointer">
            <input type="checkbox"
              class="w-4 h-4 border-2 rounded-[2px] cursor-pointer"
              [(ngModel)]="label.isChecked"
              [style.border-color]="getLabelColorValue(label.name)">
            <span class="font-semibold text-sm text-gray-800"
            [class.hidden]="!isNavShow()">{{ label.name }}</span>
          </div>
        }
      </div>
    </div>

    <!-- Create New Label -->
    <div class="flex items-center gap-3 py-2 px-3 hover:bg-gray-50 rounded-lg cursor-pointer opacity-50" [class.hidden]="!isNavShow()">
      <span class="text-lg text-gray-800">+</span>
      <span class="font-semibold text-sm text-gray-800">Create New Label</span>
    </div>
  </div>

  <!-- Right Message List -->
  <div class="inbox-messages">
    <!-- Search Bar and Actions -->
    <div class="flex items-center justify-between mb-6 mx-6 max-[730px]:flex-col max-[730px]:gap-3 max-[730px]:mx-4">
      <!-- Search Bar -->
      <div class="flex-1 xl:flex-0 relative max-[730px]:w-full">
        <div class="bg-gray-50 border border-gray-300 rounded-full px-4 py-2 pl-10 max-w-[332px] max-[730px]:max-w-full">
          <svg class="absolute left-3 top-2.5 w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
          </svg>
          <input type="text"
            placeholder="Search mail"
            [(ngModel)]="searchTerm"
            (input)="onSearch($event)"
            class="bg-transparent border-none outline-none text-sm text-gray-800 opacity-60 placeholder-gray-500 w-full">
        </div>
      </div>

      <!-- Other Actions -->
      <div class="bg-[#FAFBFD] border border-[#D5D5D5]">
        <button class="p-3 border-r border-[#D5D5D5]">
          <img src="/assets/icons/download-mono.svg" alt="download">
        </button>
        <button class="p-3">
          <img src="/assets/icons/warning-mono.svg" alt="download">
        </button>
        <button class="p-3 border-l border-[#D5D5D5]">
          <img src="/assets/icons/delete-mono.svg" alt="download">
        </button>
      </div>
    </div>

    <!-- Message List -->
    <div class="">
      @for (message of filteredMessages; track message.id) {
        <div
          class="border-b border-gray-100 py-5 max-[730px]:py-3 max-[730px]:px-4" [ngClass]="message.isChecked ? 'bg-[#487fff18]' : ''">
          <div class="flex items-center gap-3 px-6 max-[730px]:px-0 max-[730px]:flex-col max-[730px]:items-start max-[730px]:gap-2">
            <div class="flex items-center gap-3 max-[730px]:w-full max-[730px]:justify-between">
              <input type="checkbox"
                class="w-4 h-4 border border-gray-300 rounded"
                [checked]="message.isChecked"
                (change)="toggleMessageSelection(message.id)">
              <svg class="w-5 h-5 cursor-pointer"
                [ngClass]="message.isStarred ? 'text-yellow-400 fill-current' : 'text-gray-400'"
                fill="currentColor"
                viewBox="0 0 24 24"
                (click)="toggleStar(message.id)">
                <path d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"></path>
              </svg>
              <span class="font-semibold text-sm text-[#202224] opacity-70 max-[730px]:ml-auto">{{ message.time }}</span>
            </div>
            <div class="flex-1 flex items-center justify-between max-[730px]:w-full max-[730px]:flex-col max-[730px]:items-start max-[730px]:gap-1">
              <div class="flex items-center gap-3 max-[730px]:flex-wrap">
                <span class="font-bold text-sm text-gray-800 min-w-[150px] max-[730px]:min-w-0">
                  {{ message.folder === 'sent' && message.recipient ? 'To: ' + message.recipient : message.sender }}
                </span>
                @if (message.label) {
                  <span
                    class="px-2 py-1 text-xs font-semibold rounded"
                    [ngClass]="getLabelColorClasses(message.label)">
                    {{ message.label }}
                  </span>
                }
              </div>
              <span class="font-semibold text-sm text-[#202224] opacity-90 max-[730px]:text-xs max-[730px]:opacity-80">{{ truncateText(message.subject) }}</span>
            </div>
          </div>
        </div>
      }
    </div>
  </div>
</div>